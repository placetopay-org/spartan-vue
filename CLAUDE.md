# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

Spartan Vue is a Vue 3 component library (68 components) by PlaceToPay, built with TailwindCSS v4 and TypeScript. Package: `@placetopay/spartan-vue`. This is a **library**, not an application.

## Common Commands

| Command | Purpose |
|---------|---------|
| `npm run dev` | Start Nuxt docs dev server (alias: `npm run docs:dev`) |
| `npm run build` | Full library build: Vite → types → Rollup → locales → CSS → sanitize |
| `npm run test` | Vitest watch mode with UI & coverage |
| `npm run test:ci` | CI test run with coverage |
| `npx vitest run src/components/spartan/SButton/SButton.test.ts` | Run a single test file |
| `npm run lint` | ESLint with auto-fix (`.ts`, `.vue`) |
| `npm run format` | Prettier formatting |
| `npm run foli` | Format + Lint combined |
| `npm run typecheck` | TypeScript type checking via `vue-tsc` |

## Architecture

### Component Structure

Every component lives in `src/components/spartan/S{Name}/` with this standard layout:

```
SButton/
├── SButton.vue        # Vue 3 <script setup> component
├── SButton.test.ts    # Vitest + @testing-library/vue tests
├── types.ts           # TypeScript prop types with bilingual JSDoc (@en/@es)
├── styles.ts          # CVA (class-variance-authority) variant definitions
└── index.ts           # Re-exports component + types
```

Internal shared components live in `src/components/internal/` (InputContainer, Transitions, etc.).

### Key Patterns

- **Styling**: All variant styling uses CVA (`class-variance-authority`) with `tailwind-merge` for class composition. Never use inline conditional classes — define variants in `styles.ts`.
- **Pass-through props**: Components use `usePassthrough()` from `@/helpers` to allow deep customization of internal elements.
- **Polymorphic rendering**: Many components accept an `as` prop to render as different HTML elements or Vue components.
- **i18n**: Components using internal text depend on `vue-i18n`. Translations live in `src/locales/` (es, en, pt, it, fr) under the `$spartan` namespace.

### Path Aliases

| Alias | Path |
|-------|------|
| `@/*` | `./src/*` |
| `@spartan*` | `./src/components/spartan` |
| `@internal*` | `./src/components/internal` |

### Code Style

- **Prettier**: Single quotes, 4-space indent, 120 char line width, Tailwind class sorting plugin
- **ESLint**: `vue/vue3-recommended` + `@typescript-eslint/recommended` + Prettier integration
- `@typescript-eslint/no-explicit-any` is OFF
- Ignores: `dist/`, `src/components/deprecated/`

### Testing

- Framework: Vitest with `jsdom` environment and `vitest/globals` (no imports needed for `describe`, `test`, `expect`)
- Uses `@testing-library/vue` (`render`) and `@testing-library/dom` (`screen`)
- `vue-i18n` is globally mocked in `src/vitest-setup.ts` — `useI18n().t()` returns the key string
- Test files: `src/components/spartan/**/*.test.ts`

### Documentation Site

The docs site is a Nuxt 4 app in `docs/`. Each component needs bilingual docs:

- English: `docs/content/en/2.components/{category}/{n}.{slug}.md`
- Spanish: `docs/content/es/2.components/{category}/{n}.{slug}.md`
- Status tracking: `docs/app/data/componentStatus.ts`

Categories: `1.data-input`, `2.selectors`, `3.display`, `4.modals`, `5.structure`, `6.utilities`

Documentation uses the `::spartan-component` directive for interactive examples. See `docs/DOCUMENTATION_GUIDE.txt` for the full specification including `props`, `slots`, `items`, `ignore`, `hide`, `external`, and `model` options.

### Build Pipeline

The `npm run build` command runs a multi-step pipeline:
1. **Vite** — Library mode build with per-component entry points (generated by `scripts/components.js`)
2. **vue-tsc** — TypeScript declaration generation
3. **Rollup** — Bundles the Tailwind plugin (`plugin.mjs`/`plugin.cjs`)
4. **Copy locales** — Copies `src/locales/` to `dist/locales/`
5. **Copy CSS** — Copies stylesheets to `dist/styles/`
6. **Sanitize** — Cleans up the build output

### Key Dependencies

- `@headlessui/vue` — Unstyled accessible UI primitives
- `@floating-ui/vue` — Popover/tooltip positioning
- `@heroicons/vue` and `@placetopay/iconsax-vue` — Icon libraries
- `@tanstack/vue-table` — Data table engine (used by SDTable)
- `@vuepic/vue-datepicker` — Date picker (used by SInputDate)
- `class-variance-authority` — Type-safe style variants
- `tailwind-merge` — Smart Tailwind class merging
- `zod` — Schema validation
- `imask` — Input masking
